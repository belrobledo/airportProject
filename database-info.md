# Airport API | Database Documentation
<br>

## Introduction

The database was built using MySQL and set up inside a Docker container, using the official MySQL docker image. 

It will be accessed by the server-side application through the specified API Endpoints in the README file. To easily visualize and manage the data in development, a separate container running PhpMyAdmin was also set up. 

This documentation provides an overview of the database structure, including the entities and their relationships, as well as a description of the attributes of each entity.

<br>

## Entity-Relantionship Diagram

*(Open the images for better visualization)*

### ERD:
![ERD](https://i.imgur.com/QTFF3oq.png)

### ERD - Tables:
![ERD-tables](https://i.imgur.com/fonj7xQ.png)

<br>

## Database Structure

## Entities

As it can be seen in the diagrams, this database has 10 entities: User, Airport, Flight, Airplane, Ticket, Invoice, Employee, Address, City and Country, and a total of 11 tables (including the one-to-many relationship between User and Ticket: Booking).

### User

| Column       | Data Type    |
| ------------ | ------------ |
| idUser `PK`  | varchar(60)  |
| isAdmin      | boolean      |
| email        | varchar(256) |
| passwordHash | char(97)     |
| firstName    | varchar(100) |
| lastName     | varchar(100) |

- `idUser`: Random ID generated by MySQL's UUID() function.
- `passwordHash`: Password's hash generated by Argon2 library.

### Airport

| Column            | Data Type      |
| ----------------- | -------------- |
| idAirport `PK`    | char(3)        |
| name              | varchar(100)   |
| idAddress `FK`    | int            |

- `idAirport`: IATA (International Air Transport Association's) location code. It's a three-letters unique code.

### Flight

| Column                    | Data Type         |
| ------------------------- | ----------------- |
| idFlight `PK`             | int               |
| idAirportOrigin `FK`      | char(3)           |
| idAirportDestination `FK` | char(3)           |
| departureTime             | datetime          |
| distance                  | smallint unsigned |
| duration                  | smallint unsigned |
| price                     | float             |
| airline                   | varchar(50)       |
| idAirplane `FK`           | tinyint unsigned  |

- `distance`: Distance of the flight from origin to destination in Kilometers.
- `duration`: Duration of the flight in minutes.
- `price`: Price of the flight in USD.

### Airplane

| Column            | Data Type        |
| ----------------- | ---------------- |
| idAirplane `PK`   | tinyint unsigned |
| model             | varchar(50)      |
| capacity          | smallint         |

- `capacity`: Passengers's capacity of the airplane. Used to calculate flights's available seats.

### Ticket

| Column            | Data Type     |
| ----------------- | ------------- |
| idTicket `PK`     | int           |
| idFlight `FK`     | int           |
| email             | varchar(256)  |
| firstName         | varchar(100)  |
| lastName          | varchar(100)  |
| idBooking `FK`    | int           |

- `email`, `firstName` and `lastName`: Passenger's information.

### Booking

| Column            | Data Type     |
| ----------------- | ------------- |
| idBooking `PK`    | int           |
| idUser `FK`       | varchar(60)   |
| idInvoice `FK`    | int           |

- `idUser`: UUID's identifier of the user who made the booking.

### Invoice

| Column            | Data Type     |
| ----------------- | ------------- |
| idInvoice `PK`    | int           |
| issuedDate        | dateTime      |
| total             | float         |
| paymentMethod     | varchar(50)   |

- `total`: Total amount paid for the booking (in USD).

### Employee

| Column            | Data Type     |
| ----------------- | ------------- |
| idEmployee `PK`   | varchar(36)   |
| firstName         | varchar(100)  |
| lastName          | varchar(100)  |
| position          | varchar(50)   |
| idAirport `FK`    | char(3)       |

- `idEmployee`: Random ID generated by mysql's UUID() function.

### Address

| Column            | Data Type     |
| ----------------- | ------------- |
| idAddress `PK`    | int           |
| addressLine1      | varchar(100)  |
| addressLine2      | varchar(100)  |
| idCity `FK`       | int           |

### City

| Column            | Data Type         |
| ----------------- | ----------------- |
| idCity `PK`       | int               |
| name              | varchar(100)      |
| postalCode        | varchar(15)       |
| idCountry `FK`    | tinyint unsigned  |

### Country

| Column            | Data Type         |
| ----------------- | ----------------- |
| idCountry `PK`    | tinyint unsigned  |
| name              | varchar(60)       |
<br>

## Relationships

- Airport has a one-to-many relationship with Employee since an airport usually has many employee but an employee only works for one place.  
- Airport has a one-to-many relationship with Flight because every airport has several flights arriving and departing from it.
- Airport has a one-to-one relationship with Address.

- Flight has a many-to-one relationship with Airplane because the same airplane usually realizes more than one flight but a flight is only made by one airplane.
- Flight has a one-to-many relationship with Ticket because one flight has many seats/tickets for passengers.

- User has a one-to-many relationship with Ticket, since a ticket can be booked by one user and an user can book many tickets. This relationship is called Booking, which has its own table to represent it.

- Invoice has a one-to-one relationship with Booking (the relationship between User and Ticket) because each booking's payment has one invoice associated.